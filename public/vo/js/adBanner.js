'use strict';function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a){asyncGeneratorStep(h,d,e,f,g,'next',a)}function g(a){asyncGeneratorStep(h,d,e,f,g,'throw',a)}var h=a.apply(b,c);f(void 0)})}}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var AdBanner=/*#__PURE__*/function(){function a(b){_classCallCheck(this,a),this.player=b,this.player.video_.style.objectPosition='bottom',window.addEventListener('fullscreenchange',this.fullScreenChange.bind(this)),this.visibility=!0,this.closeable=!1,this.duration=30,this.createElements()}return _createClass(a,[{ key:'visibility',get:function get(){return this._visibility},set:function set(a){if(!0!==a&&!1!==a)throw'Invalid value';this._visibility=a} },{ key:'closeable',get:function get(){return this._closeable},set:function set(a){if(!0!==a&&!1!==a)throw'Invalid value';this._closeable=a} },{ key:'requestURL',get:function get(){return this._requestURL},set:function set(a){if(null!=a&&'string'!=typeof a)throw'Invalid value';this._requestURL=a} },{ key:'duration',get:function get(){return this._duration}/**
     * Duration (in seconds) for a single ad. The new value will be used the next time a banner is loaded.
     */,set:function set(a){if(null==a)throw'Invalid value';null!=this._timeout&&(clearTimeout(this._timeout),this._timeout=null),this._duration=1e3*a} }]),_createClass(a,[{ key:'createElements',value:function createElements(){return null==this.player.uiController?void this.player.on('ready',this.createElements.bind(this)):void(this.rootElement_=this.player.uiController.rootElement_[0],this.allControlsElement=this.rootElement_.querySelector('.sqp-all-controls'),this.targetPlayerHeight=this.player.video_.clientHeight,this.imgElement=document.createElement('img'),this.imgElement.className='sqp-banner-img',this.imgElement.addEventListener('load',this.imgLoaded.bind(this)),this.anchorElement=document.createElement('a'),this.anchorElement.className='sqp-banner-a',this.anchorElement.appendChild(this.imgElement),this.rootElement_.appendChild(this.anchorElement),this.closeElement=document.createElement('div'),this.closeElement.className='sqp-banner-close',this.closeElement.addEventListener('click',this.onCloseClick.bind(this)),this.anchorElement.appendChild(this.closeElement),setInterval(this.resizeElements.bind(this),500))} },{ key:'onCloseClick',value:function onCloseClick(a){a.preventDefault(),a.stopPropagation(),this.hideBanner()} },{ key:'hideBanner',value:function hideBanner(){this.anchorElement.style.display='none',this.resizeElements()} },{ key:'showBanner',value:function showBanner(){this.anchorElement.style.display='unset',this.resizeElements()} },{ key:'start',value:function start(){null!=this._timeout&&(clearTimeout(this._timeout),this._timeout=null),this.loadBanner()} },{ key:'loadBanner',value:function(){var a=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(null!=this.requestURL){a.next=2;break}throw'No requestURL provided';case 2:return a.next=4,fetch(this._requestURL);case 4:return a.next=6,a.sent.json();case 6:this.currentBanner=a.sent.data.data[0],null!=this.imgElement&&(this.imgElement.src='',this.showBanner()),-1!=this.duration&&(this._timeout=setTimeout(this.loadBanner.bind(this),this.duration)),this.updateBanner(),this.notifyImpression();case 11:case'end':return a.stop();}},a,this)}));return function loadBanner(){return a.apply(this,arguments)}}() },{ key:'notifyImpression',value:function(){var a=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(null==this.currentBanner.impression){a.next=2;break}return a.abrupt('return',fetch(this.currentBanner.impression));case 2:case'end':return a.stop();}},a,this)}));return function notifyImpression(){return a.apply(this,arguments)}}() },{ key:'updateBanner',value:function updateBanner(){this.imgElement.src=this.currentBanner.mediaURL,this.anchorElement.href=this.currentBanner.link} },{ key:'imgLoaded',value:function imgLoaded(){this.resizeElements()} },{ key:'fullScreenChange',value:function fullScreenChange(){this.resizeElements()} },{ key:'resizeElements',value:function resizeElements(){null==this.allControlsElement||(this.player.video_.style.objectPosition='',this.player.video_.style.objectPosition='bottom',this.player.video_.style.height=this.rootElement_.clientHeight-this.imgElement.clientHeight+'px',this.allControlsElement.style.height=this.rootElement_.clientHeight-this.imgElement.clientHeight+'px')} }]),a}();