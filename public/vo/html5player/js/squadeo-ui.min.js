function sqplog(){}const SQP_CONTROLS_DISPLAY_MODE_DEFAULT=0,SQP_CONTROLS_DISPLAY_MODE_ALWAYS=1,SQP_CONTROLS_DISPLAY_MODE_HIDDEN=2,FULLSCREEN_MSG_HIDE_TIMEOUT=1500;squadeo.PlayerController=function(t,e,i,o){if(this.config_=o||this.getDefaultConfig_(),this.config_.localization||(this.config_.localization={}),this.config_.hasOwnProperty('controlsHiddingDelay')||(this.config_.controlsHiddingDelay={ mouseIn:5e3,mouseOut:0 }),this.config_.hasOwnProperty('useQualityOnlyButton')||(this.config_.useQualityOnlyButton=!0),this.config_.hasOwnProperty('togglePlayPauseOnClick')||(this.config_.togglePlayPauseOnClick=!1),this.config_.hasOwnProperty('displayRelativePositionOnLive')||(this.config_.displayRelativePositionOnLive=!1),this.window=window,void 0!==this.config_.jquery)sqplog('Working with version of jQuery given as parameter: '+this.config_.jquery.fn.jquery),this._jQuery=this.config_.jquery;else{if('undefined'==typeof jQuery)throw'Impossible to find a workable version of jQuery';sqplog('No jQuery instance given as parameter, working with globally available one: '+jQuery.fn.jquery),this._jQuery=jQuery}this.rootElement_=this._jQuery('#'+t),this.videoElement_=e,this.player_=i,this.prevMouseMoveX=-1,this.prevMouseMoveY=-1,this.progressTouchEventIdentifier=void 0,this.disableProgressInteraction_=!1,this.lastFastSeekTime=-1,this.toolbarDisplayAllowed=!1,this.lastFullscreenToggleTime=0,this.customerOverlayHidden=!0,this.controlsDisplayMode=0,this._playerClickTogglePlayPauseActionTimeoutId=void 0,this.initController_(),this.player_.uiControls=this},squadeo.PlayerController.prototype.initController_=function(){this.controlsEnabled_=!1,this.controlsHidden_=!0,this.hideOverlayAllowed_=!0,this.loadUI(),this.applyLocalization(),this.videoElement_.addEventListener('webkitpresentationmodechanged',this.onPresentationModeChanged.bind(this)),this.videoElement_.addEventListener('loadeddata',this.onVideoEvent.bind(this)),this.player_.on('loaded',this.onManifestLoaded.bind(this)),this.player_.on('qualitychanged',this.onAdaptation.bind(this)),this.player_.on('trackschanged',this.onTrackChanged.bind(this)),this.player_.on('reset',this.onPlayerReset.bind(this)),this.player_.on('buffering',this.onPlayerBuffering.bind(this)),this.player_.on('error',this.onPlayerError.bind(this)),this.player_.on('timeupdate',this.onTimeUpdate.bind(this)),this.player_.on('durationchange',this.onDurationChanged.bind(this)),this.player_.on('volumechange',this.onVideoVolumeChanged.bind(this)),this.player_.on('play',this.onPlayEvent.bind(this)),this.player_.on('pause',this.onPauseEvent.bind(this)),this.player_.on('endoflivereached',this.onEndOfLiveEvent.bind(this)),document.addEventListener('fullscreenchange',this.onFullScreenChanged.bind(this)),document.addEventListener('click',this.onDocumentClick.bind(this),!1)},squadeo.PlayerController.prototype.getDefaultConfig_=function(){return{ allowLiveSeeking:!1,useQualityOnlyButton:!0,togglePlayPauseOnClick:!1,displayRelativePositionOnLive:!1 }},squadeo.PlayerController.prototype.updateConfig=function(t){this.config=Object.assign(this.config_,t)},squadeo.PlayerController.prototype.applyLocalization=function(){if('object'==typeof this.config_.localization){var t=this.config_.localization;'string'==typeof t.qualityTxt&&this.$controlsOverlay_.find('.sqp-quality-txt').html(t.qualityTxt),'string'==typeof t.audioTxt&&this.$controlsOverlay_.find('.sqp-audio-txt').html(t.audioTxt),'string'==typeof t.subtitleTxt&&this.$controlsOverlay_.find('.sqp-subtitle-txt').html(t.subtitleTxt),'string'==typeof t.liveBtnText&&this.liveButton.html(t.liveBtnText),this.$fullscreenMsg&&'string'==typeof t.fullscreenMsg&&this.$fullscreenMsg.html(t.fullscreenMsg)}},squadeo.PlayerController.prototype.loadUI=function(){sqplog('loadUI'),this.$customerOverlay=this.rootElement_.find('.sqp-customer-overlay'),this.config_.hasOwnProperty('customerOverlay')?this.setCustomerOverlay(this.config_.customerOverlay):this.config_.customerOverlay={ display:'hidden' },this.rootElement_.click(this.onPlayerClick.bind(this)),this.rootElement_.dblclick(this.onPlayerDblClick.bind(this)),this.$controlsOverlay_=this.rootElement_.find('.sqp-video-overlay'),this.playBtn_=this.rootElement_.find('.sqp-play-btn'),this.pauseBtn_=this.rootElement_.find('.sqp-pause-btn'),this.bufferingInfo_=this.rootElement_.find('.sqp-buffering'),this.bufferingValue_=this.rootElement_.find('.sqp-buffering-value'),this.bufferingImg_=this.rootElement_.find('.sqp-buffering-img'),this.bufferingInfo_.hide(0),this.bufferingValue_.hide(0),this.$playbackTimes_=this.rootElement_.find('.sqp-player-time'),this.$timeIndicationSeparator=this.rootElement_.find('.sqp-time-separator'),this.$mediaDurations_=this.rootElement_.find('.sqp-media-duration'),this.optionMenu_=this.rootElement_.find('.sqp-optmenu'),this.optionMenu_.hide(0);var t=this.rootElement_.find('.sqp-optitem-selected-content');this.optionItemSelectedContent_=t[0].innerHTML,this.optItemSelectAudio_=this.optionMenu_.find('.sqp-opt-item-audio'),this.optItemSelectAudio_.click(this.showAudioOptMenu.bind(this)),this.optMenuGlobalAudioIndication_=this.optionMenu_.find('.sqp-opt-audio-text'),this.optItemSelectQuality_=this.optionMenu_.find('.sqp-opt-item-quality'),this.currentQualityIndications_=this.rootElement_.find('.sqp-opt-quality-text'),this.player_.isFeatureEnabled('qualityselection')?this.optItemSelectQuality_.click(this.showQualityOptMenu.bind(this)):this.optItemSelectQuality_.find('.sqp-opt-sub-select-arrow').hide(0),this.optItemSelectSubtitles_=this.optionMenu_.find('.sqp-opt-item-subtitles'),this.optItemSelectSubtitles_.click(this.showSubtitlesOptMenu.bind(this)),this.optMenuGlobalSubtitlesIndication_=this.optionMenu_.find('.sqp-opt-subtitles-text'),this.globOptMenu_=this.optionMenu_.find('.sqp-optmenu-global'),this.qualityOptMenu_=this.optionMenu_.find('.sqp-optmenu-quality'),this.qualityOptMenu_.find('.sqp-opt-title').click(this.closeQualityMenu.bind(this)),this.audioOptMenu_=this.optionMenu_.find('.sqp-optmenu-audio'),this.audioOptMenu_.find('.sqp-opt-title').click(this.backToGlobalMenu.bind(this)),this.subtitlesOptMenu_=this.optionMenu_.find('.sqp-optmenu-subtitles'),this.subtitlesOptMenu_.find('.sqp-opt-title').click(this.backToGlobalMenu.bind(this)),this.optionMenuBtn_=this.rootElement_.find('.sqp-options-btn'),this.optionMenuBtn_.click(this.toggleOptionMenu.bind(this)),this.qualitySelectBtn_=this.rootElement_.find('.sqp-quality-btn'),this.qualitySelectBtn_.click(this.toggleQualityMenu.bind(this)),this.qualitySelectBtn_.hide(0),this.$tooltip_=this.rootElement_.find('.sqp-tooltip'),this.$tooltip_.hide(0),this.$tooltipTime_=this.$tooltip_.find('.sqp-tooltip-time'),this.$scrubbingThumbnail_=this.$tooltip_.find('.sqp-tooltip-thumbnail'),this.$scrubbingThumbnail_.hide(0),this.scrubbingCanvas=this.$tooltip_.find('.sqp-thumbnail-canvas')[0],this.$fullscreenMsg=this.rootElement_.find('.sqp-fullscreen-esc-msg'),this.playBtn_.click(this.onPlayClick.bind(this)),this.pauseBtn_.click(this.onPauseClick.bind(this)),this.pauseBtn_.hide(0),this.fullscreenBtn_=this.rootElement_.find('.sqp-fullscreen-btn'),this.fullscreenBtn_.click(function(t){this.setFullscreen(!0),t.stopPropagation()}.bind(this)),this.minimizeBtn_=this.rootElement_.find('.sqp-minimize-btn'),this.minimizeBtn_.click(function(t){this.setFullscreen(!1),t.stopPropagation()}.bind(this)),this.minimizeBtn_.hide(0),this.progressbarProgress_=this.rootElement_.find('.sqp-progressbar-progress-play'),this.progressbarProgress_.css('width','0%'),this.progressBar_=this.rootElement_.find('.sqp-progressbar-background'),this.progressBar_.click(this.onProgressClick.bind(this)),this.progressBar_.hover(this.onProgressHoverIn.bind(this),this.onProgressHoverOut.bind(this)),this.progressBar_.mousedown(this.onProgressMouseDown.bind(this)),this.progressBarForTouch_=this.rootElement_.find('.sqp-progressbar'),this.progressBarForTouch_.on('touchmove',this.onProgressTouchMove.bind(this)),this.progressBarForTouch_.on('touchstart',this.onProgressTouchStart.bind(this)),this.progressBarForTouch_.on('touchend',this.onProgressTouchEnd.bind(this)),this.progressbarProgress2nd_=this.rootElement_.find('.sqp-progressbar-progress-2nd'),this.progressbarProgress2nd_.css('width','0%'),this.progressbarProgress2nd_.hide(0),this.liveButton=this.rootElement_.find('.sqp-chapter-live-button'),this.liveButton.hide(0),this.liveButton.click(this.onLiveButtonClick.bind(this)),this.liveButton.hover(this.onLiveButtonHoverIn.bind(this),this.onLiveButtonHoverOut.bind(this)),this.volumeBtn_=this.rootElement_.find('.sqp-volume-btn'),this.volumeZone_=this.rootElement_.find('.sqp-volume-bar'),this.volumeZone_.data('originalWidth',this.volumeZone_.width()),this.volumeZone_.data('originalHeight',this.volumeZone_.height()),this.isDraggingVolume_=!1,this.volumeLevel_=this.volumeZone_.find('.sqp-volume-bar-level'),this.$volumeLevelIcons_=[];var e=this.volumeBtn_.find('.volume-icon-off');e.length>0&&(this.$volumeLevelIcons_.push(e),e.hide(0));for(var i=1;i<=3;i++)e=this.volumeBtn_.find('.volume-icon-l'+i),this.$volumeLevelIcons_.push(e),e.hide(0);this.onVideoVolumeChanged(),this.volumeBtn_.click(this.toggleMute.bind(this)),this.volumeZone_.attr('alwayson')||(this.volumeZone_.width(0),this.volumeBtn_.hover(function(t){this.volumeZone_.animate({ width:this.volumeZone_.data('originalWidth') },150)}.bind(this),function(t){setTimeout(function(){this.rootElement_.find('.sqp-volume-bar:hover').length>0||this.volumeZone_.animate({ width:0 },150)}.bind(this),30)}.bind(this)),this.volumeZone_.hover(function(){},function(t){setTimeout(function(){this.rootElement_.find('.sqp-volume-btn:hover').length>0||this.isDraggingVolume_||this.volumeZone_.animate({ width:0 },150)}.bind(this),30)}.bind(this))),this.volumeZone_.mousedown(function(t){this.isDraggingVolume_=!0}.bind(this)),this.volumeZone_.click(function(t){var e=this.volumeZone_[0].getBoundingClientRect(),i=document.documentElement,o=(window.pageXOffset||i.scrollLeft)-(i.clientLeft||0);volPercent=(t.pageX-o-e.left)/(e.right-e.left),this.player_.volume=volPercent,this.player_.muted=!1,t.stopPropagation()}.bind(this));var o=this._jQuery(window);o.on('mouseup',this.onWinMouseUp.bind(this)),o.on('mousemove',this.onWinMouseMove.bind(this)),o.on('keydown',this.onKeyDown.bind(this)),this._lastMouseXPosForMouseMove=-1,this._lastMouseYPosForMouseMove=-1,this.rootElement_.on('mousemove',this.onVideoMouseMove.bind(this)),this.rootElement_.find('.sqp-overlay-noautohide').hover(this.onSurfacePreventingOverlayHideIn.bind(this),this.onSurfacePreventingOverlayHideOut.bind(this)),this.playerSubtitleLayer=this.rootElement_.find('.sqp-subtitle-rendering')},squadeo.PlayerController.prototype.onProgressTouchStart=function(t){if((t=t.originalEvent).preventDefault(),void 0==this.progressTouchEventIdentifier){var e=t.changedTouches;this.progressTouchEventIdentifier=e[0].identifier,this.onProgressMouseDown(e[0]),this.onProgressHoverIn()}},squadeo.PlayerController.prototype.onProgressTouchMove=function(t){if((t=t.originalEvent).preventDefault(),void 0!=this.progressTouchEventIdentifier){var e=t.changedTouches;for(var i in e)if(e[i].identifier==this.progressTouchEventIdentifier){this.onWinMouseMove(e[i]);break}}},squadeo.PlayerController.prototype.onProgressTouchEnd=function(t){if((t=t.originalEvent).preventDefault(),void 0!=this.progressTouchEventIdentifier){var e=t.changedTouches;for(var i in e)if(e[i].identifier==this.progressTouchEventIdentifier){this.progressTouchEventIdentifier=void 0,this.onWinMouseUp(e[i]),this.onProgressHoverOut();break}}},squadeo.PlayerController.prototype.onProgressMouseDown=function(t){this.disableProgressInteraction_||(this.player_.playing&&this.player_.scrubbingAvailable&&(this.playerWasPlayingBeforeProgress=!0,this.player_.pause()),this.isDraggingProgress_=!0)},squadeo.PlayerController.prototype.onKeyDown=function(t){if(this.mouseOverPlayer_)switch(t.which){case 70:var e=Date.now();e>this.lastFullscreenToggleTime+250&&(this.lastFullscreenToggleTime=e,this.toggleFullscreen());break;case 37:this.controlsEnabled_&&!this.player_.ended&&(this.player_.currentTime-=5);break;case 39:this.controlsEnabled_&&!this.player_.ended&&(this.player_.currentTime+=5);break;case 32:this.controlsEnabled_&&!this.player_.ended&&(this.player_.playing?this.player_.pause():this.player_.play(),t.stopPropagation(),t.preventDefault())}},squadeo.PlayerController.prototype.onWinMouseUp=function(t){var e=!1;if(this.isDraggingVolume_)this.isDraggingVolume_=!1,this.volumeZone_.attr('alwayson')||setTimeout(function(){this.rootElement_.find('.sqp-volume-btn:hover').length>0||this.rootElement_.find('.sqp-volume-bar:hover').length>0||this.volumeZone_.animate({ width:0 },150)}.bind(this),500),e=!0;else if(this.isDraggingProgress_){this.isDraggingProgress_=!1;var i=this.computeProgressTimeForEvent(t);isNaN(i)||(this.player_.currentTime=i,(this.player_.ended||this.playerWasPlayingBeforeProgress)&&this.player_.play()),this.hoverInProgressBar_||this.$tooltip_.hide(0),e=!0,this.playerWasPlayingBeforeProgress=!1}e&&this.restartHideControlsOverlayTimeout_(this.config_.controlsHiddingDelay.mouseIn)},squadeo.PlayerController.prototype.onProgressHoverIn=function(t){this.hoverInProgressBar_=!0,!this.controlsEnabled_||this.optionMenuVisible_||this.hoverInLiveButton_||this.$tooltip_.show(0)},squadeo.PlayerController.prototype.onProgressHoverOut=function(t){this.hoverInProgressBar_=!1,this.isDraggingProgress_||this.$tooltip_.hide(0)},squadeo.PlayerController.prototype.onLiveButtonHoverIn=function(t){this.hoverInLiveButton_=!0,this.$tooltip_.hide(0)},squadeo.PlayerController.prototype.onLiveButtonHoverOut=function(t){this.hoverInLiveButton_=!1},squadeo.PlayerController.prototype.onSurfacePreventingOverlayHideIn=function(t){this.hideOverlayAllowed_=!1},squadeo.PlayerController.prototype.onSurfacePreventingOverlayHideOut=function(t){this.hideOverlayAllowed_=!0},squadeo.PlayerController.prototype.restartHideControlsOverlayTimeout_=function(t){0==this.controlsDisplayMode&&(void 0!==this.overlayHideTimeout_&&clearTimeout(this.overlayHideTimeout_),this.overlayHideTimeout_=setTimeout(this.hideControlsOverlay.bind(this),t))},squadeo.PlayerController.prototype.hideControlsOverlay=function(){!this.hideOverlayAllowed_||this.optionMenuVisible_||this.isDraggingVolume_||this.isDraggingProgress_||1==this.controlsDisplayMode||(this.$controlsOverlay_.fadeOut(400),this.playerSubtitleLayer.clearQueue(),this.playerSubtitleLayer.animate({ bottom:'0px' },450),this.controlsHidden_=!0,this.overlayHideTimeout_=void 0,this.rootElement_.css('cursor','none'),this.config_&&'function'==typeof this.config_.onOverlayHide&&this.config_.onOverlayHide(event),void 0!=this.config_.customerOverlay&&'default'==this.config_.customerOverlay.display&&(this.$customerOverlay.fadeOut(400),this.customerOverlayHidden=!0))},squadeo.PlayerController.prototype.onVideoMouseMove=function(t){t.preventDefault(),t.stopPropagation(),this._lastMouseXPosForMouseMove!==t.clientX||this._lastMouseYPosForMouseMove!==t.clientY?(this._lastMouseXPosForMouseMove=t.clientX,this._lastMouseYPosForMouseMove=t.clientY,this.onWinMouseMove(t,!0),this.controlsHidden_&&2!=this.controlsDisplayMode&&(this.$controlsOverlay_.show(0),this.playerSubtitleLayer.animate({ bottom:'60px' },400),this.controlsHidden_=!1,this.rootElement_.css('cursor','inherit'),'function'==typeof this.config_.onOverlayShow&&this.config_.onOverlayShow(t)),this.customerOverlayHidden&&'hidden'!=this.config_.customerOverlay.display&&(this.$customerOverlay.show(0),this.customerOverlayHidden=!1),this.restartHideControlsOverlayTimeout_(this.config_.controlsHiddingDelay.mouseIn)):sqplog('False mouse move event > discard it')},squadeo.PlayerController.prototype.onWinMouseMove=function(t,e){if(t.clientX!=this.prevMouseMoveX||t.clientY!=this.prevMouseMoveY){this.prevMouseMoveX=t.clientX,this.prevMouseMoveY=t.clientY,e?this.mouseOverPlayer_=!0:(this.mouseOverPlayer_=!1,this.restartHideControlsOverlayTimeout_(this.config_.controlsHiddingDelay.mouseOut));var i=document.documentElement;if(this.isDraggingVolume_){var o=this.volumeZone_[0].getBoundingClientRect(),s=(window.pageXOffset||i.scrollLeft)-(i.clientLeft||0);eventX=t.pageX-s;var n=0;n=eventX>=o.right?1:eventX<=o.left?0:(eventX-o.left)/(o.right-o.left),this.player_.volume=n,this.player_.muted=!1,this.updateVolumeIcon(n)}(this.isDraggingProgress_||this.hoverInProgressBar_)&&this.onMouseMoveOverProgress(t)}},squadeo.PlayerController.prototype.onMouseMoveOverProgress=function(t){var e=this.computeProgressTimeForEvent(t);if(!isNaN(e)){if(!this.tooltipOnChapter){var i=this.computeProgressTimeForEvent(t,!0);if(this.$tooltipTime_.html(''+this.getTextFromTime(i)),this.updateToolTipPosition(t),this.player_.scrubbingAvailable)if(this.player_.updateScrubbingThumbnailForTime(1e3*e))if(this.scrubbingCanvas.getContext('2d').putImageData(this.player_.scrubbingThumbnailData,0,0),this.isDraggingProgress_)this.scrubbingBackgroundCanvas.getContext('2d').putImageData(this.player_.scrubbingThumbnailData,0,0),this.$scrubbingThumbnailOVerlay.show(0)}if(this.isDraggingProgress_){this.updateProgressPosition(e);var o=e-this.lastFastSeekTime;(o>1||o<-1)&&(this.lastFastSeekTime=e,this.player_.currentTime=e)}}},squadeo.PlayerController.prototype.updateToolTipPosition=function(t){var e=document.documentElement,i=this.$tooltip_[0].getBoundingClientRect().width,o=(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0);eventX=t.pageX-o-i/2;var s=this.rootElement_[0].getBoundingClientRect(),n=2;n=eventX<s.left+2?2:eventX>s.right-i-2?s.width-i-2:eventX-s.left,this.$tooltip_.css('left',n+'px')},squadeo.PlayerController.prototype.onVideoVolumeChanged=function(t){if(this.player_.muted)this.updateVolumeIcon(-1),this.volumeLevel_.css('width','0%');else{var e=this.player_.volume;this.updateVolumeIcon(e),this.volumeLevel_.css('width',100*e+'%')}},squadeo.PlayerController.prototype.updateVolumeIcon=function(t){var e=1;t>.66?e=3:t>.33?e=2:t<0&&(e=0);for(var i=0;i<=3;i++)this.$volumeLevelIcons_[i].hide(0);this.$volumeLevelIcons_[e].show(0)},squadeo.PlayerController.prototype.toggleMute=function(t){this.player_.muted=!this.player_.muted,t.stopPropagation()},squadeo.PlayerController.prototype.backToGlobalMenu=function(t){this.audioOptMenu_.hide(0),this.qualityOptMenu_.hide(0),this.subtitlesOptMenu_.hide(0),this.optionMenu_.removeClass('sqp-optmenu-2nd').addClass('sqp-optmenu-1st'),this.globOptMenu_.show(0),t.stopPropagation()},squadeo.PlayerController.prototype.showAudioOptMenu=function(t){this.globOptMenu_.hide(0),this.optionMenu_.addClass('sqp-optmenu-2nd').removeClass('sqp-optmenu-1st'),this.audioOptMenu_.show(0),t.stopPropagation()},squadeo.PlayerController.prototype.showQualityOptMenu=function(t){this.globOptMenu_.hide(0),this.optionMenu_.addClass('sqp-optmenu-2nd').removeClass('sqp-optmenu-1st'),this.qualityOptMenu_.show(0),t.stopPropagation()},squadeo.PlayerController.prototype.showSubtitlesOptMenu=function(t){this.globOptMenu_.hide(0),this.optionMenu_.addClass('sqp-optmenu-2nd').removeClass('sqp-optmenu-1st'),this.subtitlesOptMenu_.show(0),t.stopPropagation()},squadeo.PlayerController.prototype.toggleOptionMenu=function(t){!this.optionMenuVisible_&&this.controlsEnabled_?(this.optionMenuVisible_=!0,this.backToGlobalMenu(t),this.optionMenu_.fadeIn(250)):(this.optionMenuVisible_=!1,this.optionMenu_.hide(0)),t.stopPropagation()},squadeo.PlayerController.prototype.hideOptionMenu=function(t){this.optionMenuVisible_=!1,this.optionMenu_.hide(0),t&&t.stopPropagation()},squadeo.PlayerController.prototype.closeQualityMenu=function(t){this.showingQualityBtnOnly?this.qualityOptMenu_.hide(0):this.backToGlobalMenu(t),t.stopPropagation()},squadeo.PlayerController.prototype.toggleQualityMenu=function(t){this.controlsEnabled_&&('yes'==this.qualityOptMenu_.attr('displayed')?(this.qualityOptMenu_.hide(0),this.qualityOptMenu_.attr('displayed')):(this.optionMenu_.addClass('sqp-optmenu-2nd').removeClass('sqp-optmenu-1st'),this.qualityOptMenu_.show(0),this.globOptMenu_.hide(0),this.optionMenu_.fadeIn(250),this.qualityOptMenu_.attr('displayed'))),t.stopPropagation()},squadeo.PlayerController.prototype.onManifestLoaded=function(t){this.player_.isLive()?(sqplog('onManifestLoaded LIVE stream'),null!=this.player_.seekRange()?(this.progressBar_.show(0),this.$playbackTimes_.show(0),this.$timeIndicationSeparator.show(0),this.liveButton.show(0),this.progressBarForTouch_.attr('forLive','true')):(this.progressBar_.hide(0),this.$playbackTimes_.hide(0),this.$timeIndicationSeparator.hide(0))):(sqplog('onManifestLoaded VOD stream'),this.progressBar_.show(0),this.$playbackTimes_.show(0),this.$timeIndicationSeparator.show(0));this.controlsEnabled_=!0},squadeo.PlayerController.prototype.onQualitySelected=function(t){t.currentTarget.hasAttribute('levelid')?(sqplog('setting current level: '+t.currentTarget.getAttribute('levelid')),this.player_.quality=t.currentTarget.getAttribute('levelid')):(sqplog('setting auto level'),this.player_.quality=-1),this.hideOptionMenu(t)},squadeo.PlayerController.prototype.onAudioTrackSelected=function(t){if(t.currentTarget.hasAttribute('trackid')){var e=t.currentTarget.getAttribute('trackid');sqplog('setting current audio: '+e),e!=this.player_.audioTrack&&(this.player_.audioTrack=e)}this.hideOptionMenu(t)},squadeo.PlayerController.prototype.onAdaptation=function(t){var e=this.player_.getConfiguration().abr.enabled,i=this.formatQualityLevel(t.currentLevel,!0,e),o=-1;this.currentQualityIndications_.html(i.text),i.isHD?(this.currentQualityIndications_.addClass('sqp-hd-res'),this.optionMenuBtn_.addClass('sqp-hd-res')):(this.currentQualityIndications_.removeClass('sqp-hd-res'),this.optionMenuBtn_.addClass('sqp-hd-res')),e||(o=this.player_.quality);for(var s=this.qualityOptMenu_.find('.opt-item-select'),n=this.qualityOptMenu_.find('.sqp-opt-select'),r=player.qualities,l=0;l<r.length;l++)if(r[l].active){l;break}for(var a=s.length,h=0;h<a;h++){var u=parseInt(n[h].getAttribute('levelid')),p=this._jQuery(n[h]).find('.opt-item-select')[0];p.innerHTML=u==o?this.optionItemSelectedContent_:''}},squadeo.PlayerController.prototype.formatQualityLevel=function(t,e,i){var o={ text:'',isHD:!1 };return'function'==typeof this.config_.qualityLevelFormater?this.config_.qualityLevelFormater(t,e,i):(t.hasOwnProperty('height')&&t.height>0&&(o.text+=t.height+'p',t.height>=720&&(o.isHD=!0)),e?o.text=i?'Auto '+o.text:this.formatBitrateText(t.bandwidth):(o.text.length>0&&(o.text+=' - '),o.text+=this.formatBitrateText(t.bandwidth)),o)},squadeo.PlayerController.prototype.formatBitrateText=function(t){var e;t>1e6?e=Math.round(t/1e5)/10+' Mbs':e=Math.round(t/1e3)+' Kbs';return e},squadeo.PlayerController.prototype.formatAudioTrackText=function(t){return'function'==typeof this.config_.audioTrackDisplayFormater?this.config_.audioTrackDisplayFormater(t):t.name?t.name:t.language},squadeo.PlayerController.prototype.onTrackChanged=function(t){sqplog('onTrackChanged',t);var e=this.player_.qualities,i='',o=void 0,s=0,n=!0;if(e.length>1&&this.player_.isFeatureEnabled('qualityselection')){e.forEach(function(t){i+='<div class="sqp-opt-item sqp-opt-select" levelid='+s+'>',i+='<div class="opt-item-select" levelid='+s+'></div>',t.active&&(o=t);var e=this.formatQualityLevel(t),n=e.isHD?' sqp-hd-res':'';i+='<div class="sqp-opt-value-2nd'+n+'">'+e.text+'</div></div>',s++}.bind(this)),i+='<div auto=true class="sqp-opt-item sqp-opt-select" levelid=-1><div class="opt-item-select" levelid=-1></div><div class="sqp-opt-value-2nd">Auto</div></div>';var r=this.qualityOptMenu_.find('.sqp-opt-items-list');r.html(i),r.find('.sqp-opt-item').click(this.onQualitySelected.bind(this)),this.optItemSelectQuality_.show(0)}else n=!1,this.optItemSelectQuality_.hide(0);var l=this.player_.audioTracks,a='',h=-1;sqplog('onTrackChanged, audio:',l);var u='',p=!0;if(l.length>1){var d=0;sqplog('Audio tracks: ',l),l.forEach(function(t){var e=this.formatAudioTrackText(t);u+='<div class="sqp-opt-item sqp-opt-select" trackid='+d+'>',u+='<div class="opt-item-select" trackid='+d+'>',t.active&&(a=e,h=d,u+=this.optionItemSelectedContent_),u+='</div><div class="sqp-opt-value-2nd">'+e+'</div></div>',d++}.bind(this)),(v=this.audioOptMenu_.find('.sqp-opt-items-list')).html(u),v.find('.sqp-opt-item').click(this.onAudioTrackSelected.bind(this)),this.optMenuGlobalAudioIndication_.html(a),this.optItemSelectAudio_.show(0)}else p=!1,this.optItemSelectAudio_.hide(0);var c=this.player_.textTracks,y=this.player_.textTrack,g='Off';'string'==typeof this.config_.localization.offTrackChoice&&(g=this.config_.localization.offTrackChoice);var _=!0;if(c.length>0){var f='',m=0;sqplog('subtitles tracks: ',c),f+='<div class="sqp-opt-item sqp-opt-select" trackid=-1><div class="opt-item-select" trackid=-1>',-1==y&&(f+=this.optionItemSelectedContent_);var v,b='Off';'string'==typeof this.config_.localization.offTrackChoice&&(b=this.config_.localization.offTrackChoice),f+='</div><div class="sqp-opt-value-2nd">'+b+'</div></div>',c.forEach(function(t){var e=this.formatSubtitleTrackText(t);f+='<div class="sqp-opt-item sqp-opt-select" trackid='+m+'>',f+='<div class="opt-item-select" trackid='+m+'>',m==y&&(g=e,f+=this.optionItemSelectedContent_),f+='</div><div class="sqp-opt-value-2nd">'+e+'</div></div>',m++}.bind(this)),(v=this.subtitlesOptMenu_.find('.sqp-opt-items-list')).html(f),v.find('.sqp-opt-item').click(this.onSubtitleTrackSelected.bind(this)),this.optMenuGlobalSubtitlesIndication_.html(g),this.optItemSelectSubtitles_.show(0)}else _=!1,this.optItemSelectSubtitles_.hide(0);(void 0!==o&&this.onAdaptation({ currentLevel:o }),h>=0)&&this.audioOptMenu_.find('.sqp-opt-items-list').find('[levelid='+h+']').show(0);this.showingQualityBtnOnly=!1,n?_||p||!this.config_.useQualityOnlyButton?(this.optionMenuBtn_.show(0),this.qualitySelectBtn_.hide(0)):(this.optionMenuBtn_.hide(0),this.qualitySelectBtn_.show(0),this.showingQualityBtnOnly=!0):(this.qualitySelectBtn_.hide(0),_||p?this.optionMenuBtn_.show(0):this.optionMenuBtn_.hide(0))},squadeo.PlayerController.prototype.formatSubtitleTrackText=function(t){return'function'==typeof this.config_.textTrackDisplayFormater?this.config_.textTrackDisplayFormater(t):t.name?t.language?t.name+' / '+t.language:t.name:t.language},squadeo.PlayerController.prototype.onSubtitleTrackSelected=function(t){if(t.currentTarget.hasAttribute('trackid')){var e=t.currentTarget.getAttribute('trackid');sqplog('setting current subtitle: '+(e=parseInt(e))),e!=this.player_.textTrack&&(this.player_.textTrack=e)}this.hideOptionMenu(t)},squadeo.PlayerController.prototype.onPresentationModeChanged=function(t){'picture-in-picture'===this.videoElement_.webkitPresentationMode?this.$controlsOverlay_.hide(0):this.$controlsOverlay_.fadeIn(250),sqplog(this.videoElement_.webkitPresentationMode)},squadeo.PlayerController.prototype.onFullScreenChanged=function(t){null!=document.fullscreenElement||null!=window.document.webkitFullscreenElement?(this.fullscreenBtn_.hide(0),this.minimizeBtn_.show(0)):(this.fullscreenBtn_.show(0),this.minimizeBtn_.hide(0))},squadeo.PlayerController.prototype.onVideoEvent=function(t){switch(t.type){case'playing':this.displayBuffering(!1);break;case'waiting':this.displayBufferingTimeout_=setTimeout(this.displayBuffering.bind(this),200,!0);break;case'loadeddata':this.videoElement_.setAttribute('poster','')}},squadeo.PlayerController.prototype.onPlayerReset=function(t){this.controlsEnabled_=!1,this.disableProgressInteraction_=!1,this.hideOptionMenu(),this.pauseBtn_.hide(0),this.playBtn_.show(0),this.$playbackTimes_.html('00:00'),this.$mediaDurations_.html('00:00'),this.bufferingInfo_.hide(0),this.progressbarProgress_.css('width','0%'),this.progressbarProgress2nd_.hide(0),this.liveButton.hide(0),this.progressBarForTouch_.attr('forLive','false'),this.qualitySelectBtn_.hide(0),this.rootElement_&&this.rootElement_.find('.sqp-poster-img').hide(0),this.playerWasPlayingBeforeProgress=!1,this.lastFastSeekTime=-1},squadeo.PlayerController.prototype.onPlayerError=function(t){this.onPlayerReset()},squadeo.PlayerController.prototype.onPlayerBuffering=function(t){t.buffering?this.displayBuffering(!0,t.percent):this.displayBuffering(!1)},squadeo.PlayerController.prototype.displayBuffering=function(t,e){t?(this.bufferingImg_.removeClass('sqp-buffering-img-anim').addClass('sqp-buffering-img-anim'),this.bufferingInfo_.show(0),void 0!==e&&(this.bufferingValue_.html(e+'%'),this.bufferingValue_.show(0))):(this.displayBufferingTimeout_&&(clearTimeout(this.displayBufferingTimeout_),this.displayBufferingTimeout_=void 0),this.bufferingInfo_.hide(0),this.bufferingValue_.hide(0))},squadeo.PlayerController.prototype.setFullscreen=function(t,e){t?squadeo.Player.isBrowserSafariiOS()?this.player_.video_.webkitEnterFullscreen():this.rootElement_[0].requestFullscreen():squadeo.Player.isBrowserSafariiOS()||document.exitFullscreen()},squadeo.PlayerController.prototype.toggleFullscreen=function(){null!=window.document.webkitFullscreenElement||window.document.fullscreenElement?this.setFullscreen(!1):this.setFullscreen(!0)},squadeo.PlayerController.prototype.onPlayClick=function(t){this.controlsEnabled_&&this.player_.play(),t.stopPropagation()},squadeo.PlayerController.prototype.onPauseClick=function(t){this.controlsEnabled_&&this.player_.pause(),t.stopPropagation()},squadeo.PlayerController.prototype.onPlayEvent=function(t){this.playBtn_.hide(0),this.pauseBtn_.show(0),this.rootElement_.find('.sqp-poster-img').hide(0)},squadeo.PlayerController.prototype.onPauseEvent=function(t){this.pauseBtn_.hide(0),this.playBtn_.show(0)},squadeo.PlayerController.prototype.onDurationChanged=function(t){if(this.player_.isLive()){var e=this.player_.seekRange();if(e){if(!this.config_.displayRelativePositionOnLive){var i=e.end-e.start,o=this.getTextFromTime(i);this.$mediaDurations_.html(o)}}else this.$mediaDurations_.html('Live')}else{var s=this.player_.duration;if(this.player_.isEvent()&&this.player_.currentMedia.programFinalDuration){var n=s/this.player_.currentMedia.programFinalDuration*100+'%';this.liveButton.animate({ left:n },500),this.progressbarProgress2nd_.animate({ width:n },500)}else{o=this.getTextFromTime(s);this.$mediaDurations_.html(o)}}},squadeo.PlayerController.prototype.onTimeUpdate=function(t){this.isDraggingProgress_||this.updateProgressPosition(this.player_.currentTime)},squadeo.PlayerController.prototype.onEndOfLiveEvent=function(t){this.liveButton.hide(0),this.progressBarForTouch_.attr('forLive','false')},squadeo.PlayerController.prototype.updateProgressPosition=function(t){if(this.player_.isLive()){var e=this.player_.seekRange();if(null!=e){var i=e.end-e.start,o=t-e.start,s=e.end-t,n='',r='';if(this.config_.displayRelativePositionOnLive){var l=this.player_.programInfo();if(l.start){var a=l.start+(this.player_.currentTime-e.start);this.$playbackTimes_.html(this.getTextFromDate(new Date(1e3*a))),this.$mediaDurations_.html(this.getTextFromDate(new Date(1e3*l.end)))}else{var h=new Date;this.$mediaDurations_.html(this.getTextFromDate(h)),h.setSeconds(h.getSeconds()-s),this.$playbackTimes_.html(this.getTextFromDate(h))}}else n=this.getTextFromTime(o),this.$playbackTimes_.html(n),this.$mediaDurations_.html(this.getTextFromTime(i));r=Math.min(o/i*100,100),this.progressbarProgress_.css('width',r+'%')}}else{var u=this.getProgressFullDurationForDisplay_();n=this.getTextFromTime(t);if(this.$playbackTimes_.html(n),u>0){r=t/u*100;this.progressbarProgress_.css('width',r+'%')}}},squadeo.PlayerController.prototype.computeProgressTimeForEvent=function(t,e){var i=this.progressBar_[0].getBoundingClientRect(),o=t.clientX,s=0,n=NaN;if(s=o<i.left?0:o>i.right?1:(o-i.left)/i.width,this.player_.isLive()){var r=this.player_.seekRange(),l=r.end-r.start;n=e?this.config_.displayRelativePositionOnLive?-l*(1-s):l*s:l*s+r.start}else{var a=this.getProgressFullDurationForDisplay_();a>0&&(n=a*s)}return n},squadeo.PlayerController.prototype.onProgressClick=function(t){if(this.controlsEnabled_&&!this.isDraggingProgress_&&!this.disableProgressInteraction_){var e=t.currentTarget.getBoundingClientRect(),i=(t.clientX-e.left)/e.width;if(this.player_.isLive()){var o=this.player_.seekRange(),s=o.end-o.start;r=o.start+s*i;this.player_.currentTime=r}else{var n=this.getProgressFullDurationForDisplay_();if(n>0){var r=n*i;this.player_.currentTime=r,this.player_.ended&&this.player_.play()}}t.stopPropagation()}},squadeo.PlayerController.prototype.showVideoContextMenu=function(t){if(t.target.id==this.videoElement_.id){t.preventDefault();var e=$('.sqp-ctx-menu-video');return 0==e.length&&(e=$('<div class="sqp-ctx-menu-video">This is a context menu</div>'),$('body').append(e)),e.css('top',this.mouseY(t)+'px'),e.css('left',this.mouseX(t)+'px'),e.fadeIn(500),t.stopPropagation(),!1}this.hideVideoContextMenu()},squadeo.PlayerController.prototype.getProgressFullDurationForDisplay_=function(){var t=this.player_.duration;return this.player_.isEvent()&&this.player_.currentMedia.programFinalDuration&&(t=this.player_.currentMedia.programFinalDuration),t},squadeo.PlayerController.prototype.onPlayerClick=function(t){if('secondary'===this.player_.contentType)this.player_.vastClickThroughUrl;else this.controlsEnabled_&&void 0==this._playerClickTogglePlayPauseActionTimeoutId&&this.config_.togglePlayPauseOnClick&&(this._playerClickTogglePlayPauseActionTimeoutId=setTimeout(this.onPlayerClickTogglePlayPauseAction.bind(this),200))},squadeo.PlayerController.prototype.onPlayerClickTogglePlayPauseAction=function(){this._playerClickTogglePlayPauseActionTimeoutId=void 0,this.player_.playing?this.player_.pause():this.player_.play()},squadeo.PlayerController.prototype.onPlayerDblClick=function(t){void 0!=this._playerClickTogglePlayPauseActionTimeoutId&&(clearTimeout(this._playerClickTogglePlayPauseActionTimeoutId),this._playerClickTogglePlayPauseActionTimeoutId=void 0),this.toggleFullscreen()},squadeo.PlayerController.prototype.onDocumentClick=function(t){1===(t.which||t.button)&&this.hideVideoContextMenu(),this.hideOptionMenu()},squadeo.PlayerController.prototype.hideVideoContextMenu=function(){this._jQuery('.sqp-ctx-menu-video').hide(0)},squadeo.PlayerController.prototype.mouseX=function(t){return t.pageX?t.pageX:t.clientX?t.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft):null},squadeo.PlayerController.prototype.mouseY=function(t){return t.pageY?t.pageY:t.clientY?t.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop):null},squadeo.PlayerController.prototype.getTextFromDate=function(t){return('0'+t.getHours()).slice(-2)+':'+('0'+t.getMinutes()).slice(-2)+':'+('0'+t.getSeconds()).slice(-2)},squadeo.PlayerController.prototype.getTextFromTime=function(t,e){var i=t<0;i&&(t*=-1);var o=Math.floor(t/3600),s=('0'+o).slice(-2),n=('0'+Math.floor(t/60)%60).slice(-2),r=('0'+Math.floor(t)%60).slice(-2);if(o>=1||!0===e)var l=s+':'+n+':'+r;else l=n+':'+r;return i&&(l='- '+l),l},squadeo.PlayerController.prototype.onLiveButtonClick=function(t){var e=this.player_.duration;this.player_.currentTime=e,t.stopPropagation()},squadeo.PlayerController.prototype.setCustomerOverlay=function(t){if(this.config_.customerOverlay=t,t){if(t.hasOwnProperty('htmlContent')&&(this.config_.customerOverlay.htmlContent=t.htmlContent,this.$customerOverlay.html(t.htmlContent)),t.hasOwnProperty('display'))switch(this.config_.customerOverlay.display=t.display,t.display){case'hidden':this.$customerOverlay.stop().hide(0),this.customerOverlayHidden=!0;break;case'alwaysOn':this.$customerOverlay.show(0),this.customerOverlayHidden=!1;break;case'default':this.controlsHidden_?(this.$customerOverlay.stop().hide(0),this.customerOverlayHidden=!0):(this.$customerOverlay.show(0),this.customerOverlayHidden=!1)}}else this.config_.customerOverlay={ display:'hidden' },this.$customerOverlay.hide(0)};squadeo.createPlayerWithControls=function(s,t){return squadeo.installPolyfill(),new squadeo.PlayerPlus(s,t).player},squadeo.Player.prototype.setupUIControls=function(s){this.parentLoader_&&this.parentLoader_.finalizeSetup(s)},squadeo.PlayerPlus=function(s,t){this.parentDOMElementName=s,this.parentDOMElement=document.getElementById(s),this.uiHTML='<div class="sqp-optitem-selected-content" style="display: none;"><img class="svg-icon opt-item-cur-pointer"src="IMG_ROOTimages/checked.svg"></div><video id="VIDEO_ID_PH" class="sqp-video" width="100%" height="100%"></video><div class="sqp-all-controls"><div class="sqp-customer-overlay"></div><div class="sqp-buffering sqp-center"><img class="sqp-buffering-img sqp-buffering-rotation-anim" src="IMG_ROOTimages/buffering.png"></div><div class="sqp-video-overlay" style="display:none;"><div class="sqp-optmenu sqp-optmenu-1st"><div class="sqp-optmenu-global"><div class="sqp-opt-item sqp-opt-item-audio sqp-opt-value-pick"><div class="sqp-opt-name sqp-audio-txt">Audio</div><div class="sqp-opt-value sqp-opt-audio-text">?</div><div class="sqp-opt-sub-select-arrow"><img class="svg-icon pick-arrow" src="IMG_ROOTimages/right-arrow-min.svg"></div></div><div class="sqp-opt-item sqp-opt-item-subtitles sqp-opt-value-pick"><div class="sqp-opt-name sqp-subtitle-txt">Subtitles/CC</div><div class="sqp-opt-value sqp-opt-subtitles-text">?</div><div class="sqp-opt-sub-select-arrow"><img class="svg-icon pick-arrow" src="IMG_ROOTimages/right-arrow-min.svg"></div></div><div class="sqp-opt-item sqp-opt-item-quality sqp-opt-value-pick"><div class="sqp-opt-name sqp-quality-txt">Quality</div><div class="sqp-opt-value sqp-opt-quality-text">Auto ?</div><div class="sqp-opt-sub-select-arrow"><img class="svg-icon pick-arrow" src="IMG_ROOTimages/right-arrow-min.svg"></div></div></div><div class="sqp-optmenu-audio sqp-optmenu-2nd" style="display: none;"><div class="sqp-opt-title sqp-opt-item"><div class="sqp-opt-title-back"><img class="svg-icon" src="IMG_ROOTimages/back.svg"></div><div class="sqp-opt-value-2nd sqp-audio-txt">Audio</div></div><div class="sqp-opt-list-container"><div class="sqp-opt-items-list"></div></div></div><div class="sqp-optmenu-quality sqp-optmenu-2nd" style="display: none;"><div class="sqp-opt-title sqp-opt-item"><div class="sqp-opt-title-back"><img class="svg-icon" src="IMG_ROOTimages/back.svg"></div><div class="sqp-opt-value-2nd sqp-quality-txt">Quality</div></div><div class="sqp-opt-list-container"><div class="sqp-opt-items-list"></div></div></div><div class="sqp-optmenu-subtitles sqp-optmenu-2nd" style="display: none;"><div class="sqp-opt-title sqp-opt-item"><div class="sqp-opt-title-back"><img class="svg-icon" src="IMG_ROOTimages/back.svg"></div><div class="sqp-opt-value-2nd sqp-subtitle-txt">Subtitles / CC</div></div><div class="sqp-opt-list-container"><div class="sqp-opt-items-list"></div></div></div></div><div class="sqp-video-controls"><div class="sqp-overlay-noautohide sqp-progressbar"><div class="sqp-progressbar-background pointer-cursor"><div class="sqp-chapters"><div class="sqp-chapter-live-button">LIVE</div></div><div class="sqp-progressbar-progress sqp-progressbar-progress-play sqp-ui-main-bgcolor"><div class="sqp-progressbar-progress-endpoint sqp-ui-main-bgcolor"></div></div></div></div><div class="sqp-controls-toolbar"><div class="sqp-tooltip"><div class="sqp-tooltip-time">00:00</div></div><div class="sqp-overlay-noautohide sqp-controls-box"><button type="button" class="sqp-play-btn sqp-button sqp-left"><img class="svg-icon icon"src="IMG_ROOTimages/play.svg"></button><button type="button" class="sqp-pause-btn sqp-button sqp-left"><img class="svg-icon icon"src="IMG_ROOTimages/pause.svg"></button><button type="button" class="sqp-volume-btn sqp-button sqp-left"><img class="svg-icon icon volume-icon-off" src="IMG_ROOTimages/volume-off.svg"><img class="svg-icon icon volume-icon-l1" src="IMG_ROOTimages/volume-l1.svg"><img class="svg-icon icon volume-icon-l2" src="IMG_ROOTimages/volume-l2.svg"><img class="svg-icon icon volume-icon-l3" src="IMG_ROOTimages/volume-l3.svg"></button><div class="sqp-volume-bar"><div class="sqp-volume-bar-bg"><div class="sqp-volume-bar-level"><div class="sqp-volume-bar-level-endpoint"></div></div></div></div><div class="sqp-player-controls-text sqp-player-controls-times-zone"><div class="sqp-time sqp-player-time">00:00</div><div class="sqp-time-separator">/</div><div class="sqp-time sqp-media-duration">00:00</div></div></div><div class="sqp-overlay-noautohide sqp-right sqp-controls-box"><button type="button" class="sqp-fullscreen-btn sqp-button sqp-right"><img class="svg-icon icon"src="IMG_ROOTimages/maximize.svg"></button><button type="button" class="sqp-minimize-btn sqp-button sqp-right"><img class="svg-icon icon"src="IMG_ROOTimages/minimize.svg"></button><button type="button" class="sqp-button sqp-right sqp-options-btn"><img class="svg-icon icon"src="IMG_ROOTimages/options.svg"></button><button type="button" class="sqp-button sqp-right sqp-quality-btn sqp-player-controls-text"><spanclass="sqp-opt-quality-text">Auto ?</span></button></div></div></div></div></div>',this.videoDOMId_=squadeo.findNextFreeVideoElementId(),'object'==typeof t?this.config=t:(this.config={},this.config.useSVGIcons=!0),'string'===(this.config.base,!1)?this.config.base='':'/'!==this.config.base[this.config.base.length-1]&&(this.config.base+='/'),this.injectPlayerElementInDOM_(),this.initPlayer(),this.finalizeSetup(t)},squadeo.PlayerPlus.prototype.injectPlayerElementInDOM_=function(){this.parentDOMElementRestoreContent=this.parentDOMElement.innerHTML;var s=this.uiHTML.replace('VIDEO_ID_PH',this.videoDOMId_);s=s.replace(/IMG_ROOT/g,this.config.base),this.parentDOMElement.innerHTML=s},squadeo.PlayerPlus.prototype.loadAdditionalJS_=function(){if('string'==typeof this.config.jquery&&'existing'!==this.config.jquery)this.loadJQuery_();else{if(!jQuery)throw'Squadeo Ui Controller requires jQuery to operate';this._jQuery=jQuery,this.preloadDone_()}},squadeo.PlayerPlus.prototype.onSVGLoaded=function(s){var t=s.target,i=t.$img,e=i.attr('class'),o=i.attr('id'),a=this._jQuery(t.responseXML).find('svg');void 0!==o&&(a=a.attr('id',o)),void 0!==e&&(a=a.attr('class',e+' replaced-svg')),a=a.removeAttr('xmlns:a'),i.replaceWith(a),t.resolvePromiseCB()},squadeo.PlayerPlus.prototype.onSVGLoadError=function(s){var t=s.target;console.error('Error loading resource',t),t.rejectPromiseCB()},squadeo.PlayerPlus.prototype.loadSVGIcon=function(s,t){return new Promise(function(i,e){var o=new XMLHttpRequest;o.addEventListener('load',this.onSVGLoaded.bind(this),!1),o.addEventListener('error',this.onSVGLoadError.bind(this),!1),o.addEventListener('timeout',this.onSVGLoadError.bind(this),!1),o.resolvePromiseCB=i,o.rejectPromiseCB=e,o.$img=s,o.open('GET',t,!0),o.send()}.bind(this))},squadeo.PlayerPlus.prototype.updateSVGUI_=function(){var s=this._jQuery('#'+this.parentDOMElementName).find('.svg-icon'),t=s.length,e=[];for(i=0;i<t;i++){var o=s[i].getAttribute('src');e.push(this.loadSVGIcon(this._jQuery(s[i]),o))}return Promise.all(e)},squadeo.PlayerPlus.prototype.finalizeSetup=function(s){'object'==typeof s?this.config=s:(this.config={},this.config.useSVGIcons=!0),this.loadAdditionalJS_()},squadeo.PlayerPlus.prototype.initController=function(){var s={ jquery:this._jQuery,qualityLevelFormater:this.config.qualityLevelFormater,audioTrackDisplayFormater:this.config.audioTrackDisplayFormater,textTrackDisplayFormater:this.config.textTrackDisplayFormater,localization:this.config.localization },t=['useQualityOnlyButton','togglePlayPauseOnClick','controlsHiddingDelay','displayRelativePositionOnLive'];for(k in t){var i=t[k];this.config.hasOwnProperty(i)&&(s[i]=this.config[i])}this.playerControls=new squadeo.PlayerController(this.parentDOMElementName,this.videoElement,this.player,s),this.player.uiController=this.playerControls},squadeo.PlayerPlus.prototype.initPlayer=function(){if(this.videoElement=document.getElementById(this.videoDOMId_),!squadeo.Player.isBrowserSupported())throw'Browser is not supported by Squadeo HTML5 player';this.player=new squadeo.Player(this.videoElement),this.player.license=this.config.license,this.player.parentLoader_=this,this.player.uiController=this.playerControls,this.player.once('destroyed',function(){this.parentDOMElement.innerHTML=this.parentDOMElementRestoreContent,this.player=void 0}.bind(this)),window.addEventListener('unload',function(){this.player&&this.player.destroy()}.bind(this))},squadeo.PlayerPlus.prototype.injectScriptHelper_=function(s,t,i){var e,o=document.getElementsByTagName('script')[0];document.getElementById(s)||((e=document.createElement('script')).id=s,e.onload=function(){i()},e.src=t,o.parentNode.insertBefore(e,o))},squadeo.PlayerPlus.prototype.loadJQuery_=function(){this.injectScriptHelper_('squadeo-jquery',this.config.jquery,this.isolateJQuery_.bind(this))},squadeo.PlayerPlus.prototype.isolateJQuery_=function(){this._jQuery=jQuery.noConflict(!0),this.preloadDone_()},squadeo.PlayerPlus.prototype.preloadDone_=function(){this.updateSVGUI_().then(function(){this.initController(),this.player&&this.player.emit('ready',{ type:'ready' })}.bind(this))};